"use strict";(self.webpackChunkchatgptbox=self.webpackChunkchatgptbox||[]).push([[269],{8526:(n,e,t)=>{var s=t(5861),r=t(4687),c=t.n(r),a=t(6400),o=(t(5024),t(3324)),i=t(7658),u=t(5248),l=t(1481),d=t(1072),f=t(1487),p=t(2991),h=t(5651),m=t(9923),v=t(3150),Z=t.n(v),x=t(3162),b=t.n(x),g=t(6584);const w=function(){var n=(0,d.$G)().t,e=(0,u.useState)(!0),t=(0,o.Z)(e,2),r=t[0],a=t[1],v=(0,l.Z)(null,!1),x=(0,u.useState)([]),w=(0,o.Z)(x,2),k=w[0],N=w[1],y=(0,u.useState)(null),C=(0,o.Z)(y,2),S=C[0],I=C[1],R=(0,u.useState)(null),E=(0,o.Z)(R,2),B=E[0],G=E[1],M=(0,u.useState)(!1),X=(0,o.Z)(M,2),L=X[0],U=X[1],j=(0,u.useRef)(null),A=function(){var n=(0,s.Z)(c().mark((function n(e){var t,s,r;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(j.current){try{j.current.postMessage({stop:!0}),j.current.disconnect()}catch(n){}j.current=null}return n.next=3,(0,i.Gg)(e);case 3:t=n.sent,s=t.session,r=t.currentSessions,s?I(e):r.length>0&&I(r[0].sessionId);case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();(0,u.useEffect)((function(){document.documentElement.dataset.theme=v.themeMode}),[v.themeMode]),(0,u.useEffect)((function(){(0,s.Z)(c().mark((function n(){var e,t;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=new URLSearchParams(window.location.search).get("from"),n.next=3,(0,i.Rx)();case 3:if(t=n.sent,!("store"!==e&&t[0].conversationRecords&&t[0].conversationRecords.length>0)){n.next=9;break}return n.next=7,D();case 7:n.next=12;break;case 9:return N(t),n.next=12,A(t[0].sessionId);case 12:case"end":return n.stop()}}),n)})))()}),[]),(0,u.useEffect)((function(){"sessions"in v&&v.sessions&&N(v.sessions)}),[v]),(0,u.useEffect)((function(){(0,s.Z)(c().mark((function n(){return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(k.length>0)){n.next=8;break}return n.t0=G,n.next=4,(0,i.Gg)(S);case 4:n.t1=n.sent.session,(0,n.t0)(n.t1),U(!1),setTimeout((function(){U(!0)}));case 8:case"end":return n.stop()}}),n)})))()}),[S]);var D=function(){var n=(0,s.Z)(c().mark((function n(){var e,t,s;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,i.ed)();case 2:return e=n.sent,t=e.session,s=e.currentSessions,N(s),n.next=8,A(t.sessionId);case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),P=function(){var n=(0,s.Z)(c().mark((function n(){var e,t;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,i.Rx)();case 2:e=n.sent,t=new Blob([JSON.stringify(e,null,2)],{type:"text/json;charset=utf-8"}),b().saveAs(t,"conversations.json");case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),z=function(){var n=(0,s.Z)(c().mark((function n(){var e;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,i.R1)();case 2:return e=n.sent,N(e),n.next=6,A(e[0].sessionId);case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,g.tZ)("div",{className:"IndependentPanel",children:(0,g.BX)("div",{className:"chat-container",children:[(0,g.BX)("div",{className:"chat-sidebar ".concat(r?"collapsed":""),children:[(0,g.BX)("div",{className:"chat-sidebar-button-group",children:[(0,g.tZ)("button",{className:"normal-button",onClick:function(){a(!r)},children:n(r?"Pin":"Unpin")}),(0,g.tZ)("button",{className:"normal-button",onClick:D,children:n("New Chat")}),(0,g.tZ)("button",{className:"normal-button",onClick:P,children:n("Export")})]}),(0,g.tZ)("hr",{}),(0,g.tZ)("div",{className:"chat-list",children:k.map((function(e,t){return(0,g.BX)("button",{className:"normal-button ".concat(S===e.sessionId?"active":""),style:"display: flex; align-items: center; justify-content: space-between;",onClick:function(){A(e.sessionId)},children:[e.sessionName,(0,g.tZ)("span",{className:"gpt-util-group",children:(0,g.tZ)(h.Z,{size:14,text:n("Delete Conversation"),onConfirm:function(){return(0,i.SO)(e.sessionId).then((function(n){N(n),A(n[0].sessionId)}))}})})]},t)}))}),(0,g.tZ)("hr",{}),(0,g.BX)("div",{className:"chat-sidebar-button-group",children:[(0,g.tZ)(f.Z,{text:n("Clear conversations"),onConfirm:z}),(0,g.tZ)("button",{className:"normal-button",onClick:function(){(0,m.Yo)(Z().runtime.getURL("popup.html"))},children:n("Settings")})]})]}),(0,g.tZ)("div",{className:"chat-content",children:L&&B&&B.conversationRecords&&(0,g.tZ)("div",{className:"chatgptbox-container",style:"height:100%;",children:(0,g.tZ)(p.Z,{session:B,notClampSize:!0,pageMode:!0,onUpdate:function(n,e,t){j.current=n,t.length>0&&t[t.length-1].done&&((0,i.CT)(e).then(N),G(e))}})})})]})})};var k=t(8752),N=t(294);document.body.style.margin=0,document.body.style.overflow="hidden",(0,N.vq)().then((function(n){(0,k.D0)(n)})),Z().runtime.onMessage.addListener(function(){var n=(0,s.Z)(c().mark((function n(e){var t;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:"CHANGE_LANG"===e.type&&(t=e.data,(0,k.D0)(t.lang));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()),(0,a.sY)((0,g.tZ)(w,{}),document.getElementById("app"))}},n=>{var e;e=8526,n(n.s=e)}]);